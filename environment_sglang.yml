name: rl_onoff_sglang
channels:
  - pytorch
  - conda-forge
  - defaults
dependencies:
  # Python version
  - python=3.10
  
  # Core scientific computing (conda packages)
  - numpy>=1.24.0,<2.0.0
  - scipy>=1.10.0
  - pandas>=2.0.0
  
  # PyTorch ecosystem (flexible version for SGLang)
  - pytorch>=2.0.0
  - pytorch-cuda=11.8  # CUDA support (adjust version as needed)
  - cudatoolkit=11.8  # CUDA toolkit (if needed)
  
  # CLI and utilities
  - click>=8.1.0
  - tqdm>=4.65.0
  
  # Build tools (required for SGLang kernel compilation)
  - ninja>=1.11.1
  - cmake>=3.20.0  # May be needed for building SGLang kernels
  
  # Pip packages
  - pip
  - pip:
    # Core ML libraries
    - transformers>=4.30.0
    - datasets>=2.14.0
    
    # Metrics dependencies
    - nltk>=3.8.0
    - rouge-score>=0.1.2
    
    # Additional dependencies for various packages
    - colorama>=0.2.5,<0.4.7
    - webencodings>=0.5.0
    - scikit-learn>=1.1.0
    - cycler>=0.10
    - fonttools>=4.22.0
    - kiwisolver>=1.3.1
    - nest_asyncio>=1.5.0
    - tenacity>=6.2.0
    - lxml>=4.0.0
    - markdown>=2.6.8
    
    # Missing dependencies for various packages
    - defusedxml>=0.7.1
    - cryptography>=3.4.8
    - smmap>=5.0.0
    - more-itertools>=8.14.0
    - tornado>=6.1
    - chardet>=5.0.0
    - pyasn1>=0.4.8
    
    # Version constraints for compatibility
    - pydantic<=2.10.6  # Required by llamafactory (conflicts with openai-harmony)
    - trl>=0.8.6,<=0.9.6  # Required by llamafactory
    - lark>=1.1.5,<1.2.0  # Required by pddl
    - outlines-core==0.1.26  # Required by outlines
    
    # SGLang backend - install with compiled kernels
    # Using 'sglang[all]' to ensure compiled kernels (sgl_kernel) are included
    # If you get "ModuleNotFoundError: No module named 'sgl_kernel'", see requirements.txt notes
    - "sglang[all]>=0.1.0"
    
    # Development dependencies
    - pytest>=7.4.0
    - pytest-cov>=4.1.0
    - black>=23.7.0
    - flake8>=6.1.0

